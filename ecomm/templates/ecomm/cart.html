{% extends "base.html" %} {% block title %} FastCart | Cart {% endblock title %}
{% block body %} {% load static %}

<div class="cart-container">
  <div class="cart-header">
    <div>
      <h1 class="cart-title">Your Cart</h1>
      <p class="cart-count">There are 1 products in your cart</p>
    </div>
    <form method="POST" action="{% url 'clear_cart' %}" style="display: inline">
      {% csrf_token %}
      <button type="submit" class="clear-cart">
        <i class="fa-solid fa-trash"></i> Clear Cart
      </button>
    </form>
  </div>

  <div class="Main-content">
    <div class="cart-table-container">
      <form method="POST" action="">
        {% csrf_token %}
        <table class="cart-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Title</th>
              <th>Unit Price</th>
              <th>Quantity</th>
              <th>Subtotal</th>
              <th>Remove</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr>
              <td>
                <img
                  src="{{ item.product.image.url }}"
                  alt="{{ item.product.name }}"
                  class="product-image"
                />
              </td>
              <td>{{ item.product.name }}</td>
              <td>
                <div class="price unit-price">
                  ${{ item.product.new_price|default:item.product.price }}
                </div>
              </td>
              <td>
                <input
                  type="number"
                  name="quantity_{{ item.id }}"
                  value="{{ item.quantity }}"
                  min="1"
                  max="{{ item.product.stock }}"
                  class="quantity-input"
                />
              </td>
              <td><div class="subtotal">${{ item.get_total_price }}</div></td>
              <td>
                <a
                  href="{% url 'remove_from_cart' item.id %}"
                  class="remove-btn"
                >
                  <i class="fa-solid fa-trash"></i>
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <div class="cart-actions">
          <a href="{% url 'index' %}" class="continue-shopping">
            ← Continue Shopping
          </a>
          <button type="submit" class="update-cart">
            <i class="fa-solid fa-rotate"></i> Update Cart
          </button>
        </div>
      </form>
    </div>

    <div class="checkout-sidebar">
      <div class="summary-card">
        <div class="summary-row">
          <span class="summary-label">Subtotal</span>
          <span class="summary-value" id="cart-subtotal">${{ total }}</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Shipping</span>
          <span class="summary-value">Free</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Total</span>
          <span class="summary-value" id="cart-total">${{ total }}</span>
        </div>
        <button class="checkout-btn">Proceed to Checkout →</button>
      </div>
    </div>
  </div>
</div>
{% endblock body %}
